export const requireRol = (...allowedRoles) => {
  return (req, res, next) => {
    if (!req.user || !req.user.rol) {
      return res.status(403).json({ error: "No tienes permisos para esta acciÃ³n" });
    }

    const userRole = req.user.rol.toLowerCase(); // ðŸ”½ normaliza el rol del usuario
    const normalizedRoles = allowedRoles.map(r => r.toLowerCase()); // ðŸ”½ normaliza los permitidos

    if (!normalizedRoles.includes(userRole)) {
      return res.status(403).json({ error: "No tienes permisos para esta acciÃ³n" });
    }

    next();
  };
};
